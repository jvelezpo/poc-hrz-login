#!/usr/bin/env node
'use strict';

const Jsonfile = require('jsonfile');

const argv = require('./cli/cli');
const props = require('./pager-cli-properties.js');

require('./polyfill');

const options = [];

if (argv.brand) {
    options.push(`brand: ${argv.brand}`);
    props.brand = argv.brand;
}

if (argv.envName) {
    options.push(`envName: ${argv.envName}`);
    props.envName = argv.envName;
}

if (argv.branch) {
    options.push(`branch: ${argv.branch}`);
    props.branch = argv.branch;
}

if (argv.domainPrefix) {
    options.push(`domainPrefix: ${argv.domainPrefix}`);
    props.domainPrefix = argv.domainPrefix;
}

if (argv.version) {
    console.log(`pager-cli version: ${require('./package.json').version}`);
}

if (argv.save) {
    Jsonfile.writeFile(`${props.root}/.pagerclirc`, props, { spaces: 2 }, (err) => {
        if (err) {
            console.error(err.message);
        }
        else {
            console.log(`saved options to ~/.pagerclirc \n${options}`);
            if (argv.action) {
                console.error('pager-cli no longer supports -a API.  See README.md for updated API.');
            }
        }
    });
}
else if (argv.action) {
    console.error('pager-cli no longer supports -a API.  See README.md for updated API.');
}
